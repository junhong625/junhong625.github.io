---
layout : post
title : '[빅데이터를 지탱하는 기술] 2-1 크로스 집계의 기본'
subtitle : '[빅데이터를 지탱하는 기술] 정리'
gh-repo: junhong625/Study
gh-badge: [star, fork, follow]
tags : [빅데이터를 지탱하는 기술, Study]
comments: true
---

# 2-1 크로스 집계의 기본
- - - 

## 트랜잭션 테이블, 크로스 테이블, 피벗 테이블
### - '크로스 집계'의 개념
- **크로스 테이블(cross table)** : 행과 열이 교차하는 부분에 데이터가 들어가는 테이블. ex) 스프레드시트(엑셀)
    - 크로스 테이블은 시각적으로 보기 좋은 보고서이지만, 데이터베이스에서는 다루기 어려운 데이터임(행 추가는 간단하지만 열 추가는 간단하지 않음)
- **트랜잭션 테이블(transaction table)** : 데이터가 열 방향이 아닌 행 방향으로만 증가하는 테이블
- **크로스 집계(cross tabulation)** : 트랜잭션 테이블에서 크로스 테이블로 변환하는 과정
- **피벗 테이블(pivot table)** : 스프레드시트에서 소량의 데이터를 크로스 집계하는 편리한 기능
<br>
<br>

### 피벗 테이블 기능에 의한 크로스 집계
- 피벗 테이블에서는 행과 열이 교차하는 부분의 값은 자동으로 집계됨(기본값은 '합계'지만 '평균', '최댓값', 이전 값과의 '차'도 계산 가능)
- **피벗 그래프(pivot graph)** : 결과를 테이블에 정리하고 그래프로 시각화하는 기능
<br>
<br>

## 룩업 테이블
### - 테이블을 결합하여 속성 늘리기
- **룩업 테이블(lookup table)** : 트랜잭션 테이블에 새로운 항목 추가가 아닌 다른 테이블과의 결합할 때 사용하는 기능
- 트랜잭셕 테이블과 룩업테이블은 서로 독립적으로 관리 가능
- 룩업 테이블은 데이터 분석 용도에 따라 자유롭게 변경 가능하여 분석하는데 보다 편리함

<br>
<br>

## 크로스 집계 방법 
[실습 파일 링크]("https://github.com/junhong625/Study/tree/master/%EB%B9%85%EB%8D%B0%EC%9D%B4%ED%84%B0%EB%A5%BC%20%EC%A7%80%ED%83%B1%ED%95%98%EB%8A%94%20%EA%B8%B0%EC%88%A0/2-1%EC%9E%A5%20%EC%8B%A4%EC%8A%B5")
1. BI 도구에 의한 크로스 집계
    - 자주 데이터를 살펴볼 때는 엑셀보다 BI 도구가 보다 편리함
2. Pandas에 의한 크로스 집계
    - 스크립트로 크로스 집계를 실행할 때는 pandas를 이용하는 것이 편리
3. SQL에 의한 테이블의 집계
    - 대량 데이터의 크로스 집계 사전 준비
    - 피벗 테이블에 의한 크로스 집계는 간편하지만 데량의 데이터는 처리 할 수 없음(BI 도구와 pandas도 수백만 레코드를 넘어가면 속도 저하)
    - 대량의 데이터 크로스 집계 시 SQL을 사용하여 데이터 **집계(aggregation)**, 즉 sum()과 같은 **집계 함수(aggregate functions)**를 이용해 데이터 감소 고려 필요
- **데이터 집계의 프로세스** : SQL로 집계하는 것을 지칭
- **시각화 프로세스** : 시각화 도구로 크로스 집계
> 데이터를 집계하는데 뛰어난 SQL과 크로스 집계에 뛰어난 시각화 도구를 결합하면 이론상으로 무한히 많은 데이터도 크로스 집계 가능
<br>
<img height=400 src="https://user-images.githubusercontent.com/83000975/165053359-922491f5-bdd3-47c5-987d-6242344dbc9a.jpeg">

<sub><b>[데이터를 집계해서 시각화하기]</b></sub>
<br>
<br>

### 테이블의 종횡 변환
- **종방향 테이블(vertical table)** : 다수의 행(로우)로 구성된 테이블 = 트랜잭션 테이블
- **횡방향 테이블(horizonial table)** : 다수의 열(컬럼)으로 구성된 테이블 = 크로스 테이블
- **피벗(pivot)** : 종방향 테이블을 횡방향 테이블로 상호 변환 = **종횡 변환**
- **언피벗(unpivot)** : 횡방향 테이블을 종방향 테이블로 변환 
<br>
<br>

## 데이터 집계 -> 데이터 마트 -> 시각화
### - 시스템 구성은 데이터 마트의 크기에 따라 결정된다.
- 데이터 마트가 작을수록 시각화하는 것이 간단하지만, 원래 데이터 포함된 정보를 잃어버리게 되어 시각화의 프로세스에서 할 수 있는 것이 줄어듬
    - 이런 경우, 피벗 테이블과 BI 도구를 사용해 대화적인 데이터를 검색한다면 정보 부족으로 곤란한 상황에 처하게 됨
    - 반대로 너무 많은 정보를 남기게되면 좋은 시각화를 할 수 없게 될 우려가 있음
- **데이터 마트의 크기는 시각화 퀄리티와 [트레이드 오프(trade off)]("https://ko.wikipedia.org/wiki/%ED%8A%B8%EB%A0%88%EC%9D%B4%EB%93%9C%EC%98%A4%ED%94%84")의 관계에 있으며, 필요에 따라 적절히 결정해야 함**
- 데이터 양을 수백만건 정도까지 줄일 수 있다면 시각화 가능하기에 특별한 시스템이 필요없지만 그렇지 않다면 작은 데이터베이스를 사용하여 데이터 마트를 만들어야 함
